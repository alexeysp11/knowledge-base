# Многопоточность в ASP.NET

Платформа ASP.NET по своей природе является многопоточной и предоставляет модели программирования, которые защищают нас от сложности использования потоков.

ASP.NET использует [пул потоков] .NET (https://learn.microsoft.com/en-us/dotnet/api/system.threading.threadpool) (который можно настроить).
Каждый запрос принимается одним из потоков пула потоков до тех пор, пока каждый поток не будет занят.
Затем очередь запросов в стеке IIS, пока это тоже не выльется. Оттуда новые запросы встречаются с очень уродливым сообщением «Сервер недоступен».

## Что такое пул потоков

В компьютерном программировании [пул потоков](https://en.wikipedia.org/wiki/Thread_pool) — это шаблон проектирования программного обеспечения, предназначенный для достижения параллельного выполнения в компьютерной программе. Пул потоков, который часто называют моделью реплицированных рабочих или рабочих-команд, поддерживает несколько потоков, ожидающих выделения задач для одновременного выполнения контролирующей программой.

## Контроллеры

В ASP.NET многопоточность реализуется посредством использования контроллеров и базовой платформы. ASP.NET по своей сути является многопоточным, что означает, что он может обрабатывать несколько запросов одновременно, используя отдельные потоки. Контроллеры в ASP.NET предоставляют способ обработки входящих запросов и их многопоточной обработки, что позволяет эффективно обрабатывать веб-запросы без необходимости напрямую управлять потоками.

Платформа ASP.NET абстрагирует большую часть сложностей многопоточности, предоставляя модель программирования, которая защищает разработчиков от необходимости управлять потоками вручную. Это позволяет разработчикам сосредоточиться на написании кода для обработки запросов и бизнес-логики, не беспокоясь об управлении потоками на низком уровне.

## Микросервисная архитектура

Микросервисная архитектура может использоваться как альтернатива реализации многопоточности вручную в коде. В микросервисной архитектуре различные компоненты приложения разрабатываются и развертываются как независимые службы, каждый из которых работает в своем собственном процессе и взаимодействует друг с другом по сети. Это обеспечивает масштабируемость, отказоустойчивость и гибкость в управлении различными частями приложения.

Плюсы использования микросервисной архитектуры включают улучшенную масштабируемость, изоляцию сбоев, разнообразие технологий, а также более простое развертывание и управление отдельными сервисами. Однако есть и минусы, такие как повышенная сложность управления распределенными системами, потенциальные потери производительности из-за сетевых коммуникаций и дополнительные операционные издержки при управлении несколькими сервисами.

Реализация многопоточности вручную в коде может быть более выгодной в определенных случаях, когда необходим детальный контроль над управлением потоками, например, в критических по производительности разделах кода или при работе с определенными ограничениями оборудования или ресурсов.
