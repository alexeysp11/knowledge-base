# Использование docker в GitHub Actions и GitLab CI/CD

Использование GitHub Actions или GitLab CI/CD является стандартом индустрии для автоматизации многих процессов, включая сборку, запуск тестов, публикацию.

В корпоративной среде бывает так, что некоторые проекты требуют дополнительной настройки окружения (например, установка каких-то утилит на компьютер, выставление переменных среды). Нередко такие проблемы возникают при работе с legacy проектами или проектами на .NET Framework.

Есть проблема, связанная с тем, что если корпоративный GitLab-сервер работает на Linux, то напрямую запустить сборку проектов .NET Framework, предназначенных для Windows, вряд ли получится. В качестве возможных решений можно рассматривать:

- Использование Docker-образа с Windows, чтобы обеспечить необходимую среду для сборки.
- Использование виртуальных машин (например, с помощью VirtualBox или VMware) с Windows на сервере GitLab для выполнения сборки.

## Анализ рациональности использования Docker

### Когда рационально использовать Docker

1. **Разработка и тестирование микросервисов**: Разработчики могут запускать микросервисы в изолированных Docker-контейнерах, что гарантирует, что каждая служба использует свои зависимости и не конфликтует с другими.
2. **Разработка и тестирование веб-приложений**: Создание изолированного окружения для веб-приложения (фронтенд/бэкенд, базы данных) для гарантированного тестирования.
3. **Разработка и тестирование для разных платформ**: Создайте Docker-образ для разных платформ (Windows, Linux, macOS) и тестируйте приложение на каждой из них.
4. **Деплоймент приложения**: Docker-образы упрощают деплоймент приложения в различные среды (dev, test, production), гарантируя, что приложение будет работать точно так же, как и в разработке.
5. **Обучение и демонстрация**: Создайте Docker-образ с учебным приложением или демонстрацией, который можно легко развернуть и запустить на любом компьютере.
6. **Изолированное окружение для инструментов**: Запускайте инструменты, которые требуют специальных зависимостей или настроек, в изолированных Docker-контейнерах, чтобы они не влияли на ваше локальное окружение.
8. **Простой запуск**: Запуск приложения в Docker-контейнере обычно прост с помощью одной команды.
9. **Совместимость с CI/CD**: Docker легко интегрируется в CI/CD pipelines.

### Когда Docker не рационален

1. **Небольшие приложения без зависимостей**: Если у вас небольшое приложение без особых зависимостей, Docker может быть избыточным.
2. **Простые приложения на одной платформе**: Если ваше приложение не требует специфических настроек или не работает на разных платформах, Docker может быть избыточным.
3. **Приложения, которые требуют прямой интеграции с хостом**: Если ваше приложение сильно зависит от специфики хоста (например, доступа к железу или специфическим системным вызовам), Docker может не подходить.
4. **Слишком большие и сложные приложения**: Docker может быть не самым эффективным инструментом для очень больших и сложных приложений, где необходимо управлять огромным количеством контейнеров.
5. **Ограниченная производительность**: В некоторых случаях запуск приложения в Docker-контейнере может привести к незначительному снижению производительности.
6. **Отсутствие необходимых ресурсов**: Docker требует некоторых ресурсов для работы. Если у вас ограниченные ресурсы (процессор, память), Docker может замедлить работу вашего компьютера.
7. **Слишком сложные настройки**: Если ваше приложение требует сложной конфигурации или интеграции с другими системами, Docker может создать лишние сложности.
8. **Проблемы с сетью**: Может быть сложно настроить сетевое взаимодействие между контейнерами.
9. **Проблемы с доступом**: Может быть сложно получить доступ к ресурсам хоста из контейнера.
10. **Необходимость обновления**: Docker-образы и инструменты могут требовать обновления.
11. **Увеличение времени сборки**: Использование Docker может увеличить время сборки приложений, в результате чего в некоторых случаях использование Docker может снизить производительность CI/CD pipelines.
12. **Сложность**: Docker может быть сложным для освоения и настройки для начинающих пользователей.

## Исследование

### План

- [ ] Исследовать, как собрать код из git репозитория с использованием docker:
    - [x] локально.
    - [ ] с помощью GitHub Actions.
    - [ ] с помощью GitLab CI/CD.
- [x] Добавить команды для настройки переменных среды.
- [ ] Добавить команды для установки утилит.

### Сборка проектов с помощью docker локально

Как использовать `Dockerfile`:

1. Открыть терминал в директории, которая содержит `Dockerfile`.

2. Выполнить команды (собрать образ Docker и запустить контейнер):

```
docker build -t knowledge-base .
docker run -it knowledge-base
```

3. Команды для настройки переменных среды

```
docker build -f file_name -e MYSQL_ROOT_PASSWORD=root
docker run -e "env_var_name=another_value"
```
